<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SmartBMI ‚Äì ·ª®ng d·ª•ng t√≠nh ch·ªâ s·ªë BMI</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }
    body {
      margin: 0;
      background: linear-gradient(160deg, #e0f7fa, #f9ffff);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      color: #222;
    }
    header {
      width: 100%;
      text-align: center;
      background: #00acc1;
      color: white;
      font-size: 22px;
      padding: 15px 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      letter-spacing: 0.5px;
    }
    main {
      width: 100%;
      max-width: 450px;
      background: white;
      margin: 25px;
      padding: 20px 25px;
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    label {
      display: block;
      font-weight: 600;
      margin-top: 10px;
    }
    input, select, button {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-top: 5px;
      font-size: 15px;
    }
    button {
      background: #00acc1;
      border: none;
      color: white;
      font-weight: bold;
      margin-top: 18px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #008b9e; }
    .result {
      margin-top: 20px;
      text-align: center;
      animation: fadeIn 0.5s ease;
    }
    .bmi-value {
      font-size: 36px;
      font-weight: bold;
      color: #00acc1;
    }
    .category {
      font-weight: 600;
      color: #444;
      margin-top: 5px;
    }
    .advice {
      font-style: italic;
      margin-top: 10px;
      color: #555;
    }
    .table-wrap {
      overflow-x: auto;
      margin-top: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #e0f7fa;
      font-weight: 600;
    }
    tr.active {
      background: #b2ebf2;
      font-weight: bold;
    }
    .history {
      margin-top: 25px;
      border-top: 1px solid #eee;
      padding-top: 15px;
    }
    .history h3 {
      margin: 0 0 10px;
      font-size: 16px;
      text-align: center;
    }
    canvas { width: 100%; height: 200px; }
    .btn-group {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .reset-btn {
      background: #f44336;
    }
    .reset-btn:hover { background: #d32f2f; }
    footer {
      text-align: center;
      color: #777;
      font-size: 13px;
      margin-bottom: 15px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 500px) {
      main { margin: 10px; padding: 15px; }
      header { font-size: 18px; padding: 12px; }
      .bmi-value { font-size: 30px; }
    }
  </style>
</head>
<body>
  <header>üíô SmartBMI ‚Äì T√≠nh ch·ªâ s·ªë BMI</header>
  <main>
    <label for="gender">Gi·ªõi t√≠nh</label>
    <select id="gender">
      <option value="nam">Nam</option>
      <option value="nu">N·ªØ</option>
    </select>

    <label for="age">ƒê·ªô tu·ªïi</label>
    <select id="age">
      <option value="treem">Tr·∫ª em</option>
      <option value="nguoilon" selected>Ng∆∞·ªùi l·ªõn</option>
    </select>

    <label for="height">Chi·ªÅu cao (m)</label>
    <input type="number" id="height" placeholder="VD: 1.70" step="0.01" />

    <label for="weight">C√¢n n·∫∑ng (kg)</label>
    <input type="number" id="weight" placeholder="VD: 60" step="0.1" />

    <div class="btn-group">
      <button id="calcBtn">T√≠nh BMI</button>
      <button class="reset-btn" id="resetHistory">L√†m m·ªõi l·ªãch s·ª≠</button>
    </div>

    <div class="result" id="result">
      <p>Nh·∫≠p th√¥ng tin ƒë·ªÉ xem k·∫øt qu·∫£...</p>
    </div>

    <div class="table-wrap" id="detailTable" style="display:none;">
      <table>
        <thead>
          <tr>
            <th>M·ª©c ƒë·ªô</th>
            <th>Ch·ªâ s·ªë BMI</th>
            <th>Ph√¢n lo·∫°i</th>
            <th>Nguy c∆°</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>&lt; 18.5</td><td>G·∫ßy</td><td>Th·∫•p</td></tr>
          <tr><td>2</td><td>18.5 ‚Äì 22.9</td><td>B√¨nh th∆∞·ªùng</td><td>Trung b√¨nh</td></tr>
          <tr><td>3</td><td>23 ‚Äì 24.9</td><td>Th·ª´a c√¢n</td><td>TƒÉng</td></tr>
          <tr><td>4</td><td>‚â• 25</td><td>B√©o ph√¨</td><td>Cao</td></tr>
        </tbody>
      </table>
    </div>

    <div class="history">
      <h3>üìä L·ªãch s·ª≠ BMI g·∫ßn ƒë√¢y</h3>
      <canvas id="bmiChart"></canvas>
    </div>
  </main>
  <footer>¬© 2025 by MAIAN ‚Äì B·∫£o v·ªá s·ª©c kh·ªèe c·ªßa b·∫°n üí™</footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const calcBtn = document.getElementById("calcBtn");
    const result = document.getElementById("result");
    const ctx = document.getElementById("bmiChart").getContext("2d");
    const resetHistory = document.getElementById("resetHistory");
    const detailTable = document.getElementById("detailTable");
    let history = JSON.parse(localStorage.getItem("bmiHistory") || "[]");
    let chart;

    function updateChart() {
      const labels = history.map((e, i) => `L·∫ßn ${i + 1}`);
      const data = history.map((e) => e.value);
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [
            {
              label: "Ch·ªâ s·ªë BMI",
              data,
              borderColor: "#00acc1",
              borderWidth: 2,
              fill: false,
              tension: 0.3,
              pointBackgroundColor: "#00acc1",
            },
          ],
        },
        options: {
          scales: { y: { beginAtZero: true } },
          plugins: { legend: { display: false } },
        },
      });
    }

    function getAdvice(bmi, gender, ageGroup) {
      let category = "", advice = "";
      if (bmi < 18.5) {
        category = "G·∫ßy";
        advice = "B·∫°n n√™n b·ªï sung dinh d∆∞·ª°ng v√† t·∫≠p th·ªÉ d·ª•c nh·∫π ƒë·ªÉ tƒÉng c√¢n l√†nh m·∫°nh.";
      } else if (bmi < 23) {
        category = "B√¨nh th∆∞·ªùng";
        advice = "Tuy·ªát v·ªùi! H√£y duy tr√¨ l·ªëi s·ªëng hi·ªán t·∫°i c·ªßa b·∫°n.";
      } else if (bmi < 25) {
        category = "Th·ª´a c√¢n";
        advice = "C·∫ßn ki·ªÉm so√°t ch·∫ø ƒë·ªô ƒÉn v√† t·∫≠p luy·ªán h·ª£p l√Ω ƒë·ªÉ gi·∫£m c√¢n.";
      } else {
        category = "B√©o ph√¨";
        advice = "B·∫°n n√™n g·∫∑p chuy√™n gia dinh d∆∞·ª°ng ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n gi·∫£m c√¢n an to√†n.";
      }
      if (ageGroup === "treem") advice += " (V·ªõi tr·∫ª em, n√™n tham kh·∫£o bi·ªÉu ƒë·ªì tƒÉng tr∆∞·ªüng c·ªßa WHO.)";
      if (gender === "nu" && bmi >= 23 && bmi < 25) advice += " (Ph·ª• n·ªØ th∆∞·ªùng c√≥ t·ª∑ l·ªá m·ª° cao h∆°n, n√™n ch√∫ √Ω h∆°n.)";
      return { category, advice };
    }

    calcBtn.onclick = () => {
      const height = parseFloat(document.getElementById("height").value);
      const weight = parseFloat(document.getElementById("weight").value);
      const gender = document.getElementById("gender").value;
      const ageGroup = document.getElementById("age").value;

      if (!height || !weight || height <= 0 || weight <= 0) {
        result.innerHTML = '<p style="color:red;">‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·ªß th√¥ng tin h·ª£p l·ªá!</p>';
        detailTable.style.display = "none";
        return;
      }

      const bmi = (weight / (height * height)).toFixed(1);
      const { category, advice } = getAdvice(bmi, gender, ageGroup);

      result.innerHTML = `
        <p>Ch·ªâ s·ªë BMI c·ªßa b·∫°n:</p>
        <div class="bmi-value">${bmi}</div>
        <div class="category">Ph√¢n lo·∫°i: <b>${category}</b></div>
        <div class="advice">${advice}</div>
      `;

      detailTable.style.display = "block";
      highlightRow(bmi);

      history.push({ value: bmi });
      if (history.length > 10) history.shift();
      localStorage.setItem("bmiHistory", JSON.stringify(history));
      updateChart();
    };

    function highlightRow(bmi) {
      document.querySelectorAll("tbody tr").forEach((tr) => tr.classList.remove("active"));
      const rows = document.querySelectorAll("tbody tr");
      if (bmi < 18.5) rows[0].classList.add("active");
      else if (bmi < 23) rows[1].classList.add("active");
      else if (bmi < 25) rows[2].classList.add("active");
      else rows[3].classList.add("active");
    }

    resetHistory.onclick = () => {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a l·ªãch s·ª≠ BMI kh√¥ng?")) {
        history = [];
        localStorage.removeItem("bmiHistory");
        updateChart();
      }
    };

    updateChart();
  </script>
</body>
</html>
